<!DOCTYPE html>
<html>
    <head>
        <title>game start</title>
        <link rel="stylesheet" href="game.css">
    </head>
    <body>
    <header>
        <a href="#" class="logo">?</a>
        <ul>
            <li><a href="index.html" class="logo">end</a></li>
        </ul>
    </header>
    <section class="game-container">
        <img src="demo2_12.png" id="background">
        <img src="idle.gif" id="character">
        <img src="zombie-idle.gif" id="zombie">
        

        

    </section>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const character = document.getElementById('character');
           
            // 캐릭터 위치 초기화
            let posX = 40; // 백분률
            let posY = 10; 
            const moveSpeed = 0.4; // 이동속도

            // 캐릭터 상태
            let isMoving = false;
            let isShooting = false;
            let facingRight = true;
            
            // 캐릭터위치 update
            function updateCharacterPosition() {
                character.style.left = `${posX}%`;
                character.style.bottom = `${posY}%`;
            }
            

            // 캐릭터 에니메션 update
            function updateCharacterAnimation() {
                if (isShooting) {
                    character.src = "shot.gif";
                } else if (isMoving) {
                    character.src = "run.gif";
                } else {
                    character.src = "idle.gif";
                }
                
                // 방향 설정
                if (facingRight) {
                    character.style.transform = `translateX(-50%) scale(0.3) scaleX(1)`;
                } else {
                    character.style.transform = `translateX(-50%) scale(0.3) scaleX(-1)`;
                }
            }

            // 키 입력 상테
            const keyState = {};
            
            // 키 눌을때 사건
            document.addEventListener('keydown', function(event) {
                const key = event.key.toLowerCase();
                keyState[key] = true;
                
                // 슈팅 입력 키
                if (['e', 'r', 'q', 'shift'].includes(key)) {
                    isShooting = true;
                    updateCharacterAnimation();
                    
                    // 设置一个定时器，在短暂时间后停止射击动画
                    setTimeout(() => {
                        isShooting = false;
                        updateCharacterAnimation();
                    }, 300);
                }
            });
            
            // 키 눌으지 않을때 사건
            document.addEventListener('keyup', function(event) {
                const key = event.key.toLowerCase();
                keyState[key] = false;
                
                
            });
            // 마우스 눌을때 사건
            document.addEventListener('mousedown', function(event) {
                isShooting = true;
                updateCharacterAnimation();
                
                // 设置一个定时器，在短暂时间后停止射击动画
                setTimeout(() => {
                    isShooting = false;
                    updateCharacterAnimation();
                }, 300);
            });
            /// 캐릭터 이동
            function moveCharacter() {
                let wasMoving = isMoving;
                isMoving = false;
                
                
                if (keyState['w'] && posY < 80) {
                    posY += moveSpeed;
                    isMoving = true;
                }
               
                if (keyState['a'] && posX > 5) {
                    posX -= moveSpeed;
                    isMoving = true;
                    facingRight = false;
                }
                
               
                if (keyState['s'] && posY > -15) {
                    posY -= moveSpeed;
                    isMoving = true;
                }
                
                
                if (keyState['d'] && posX < 95) {
                    posX += moveSpeed;
                    isMoving = true;
                    facingRight = true;
                }
                
                // 이동상태가 변화 발생하면 ,에니메션 update
                if (wasMoving !== isMoving && !isShooting) {
                    updateCharacterAnimation();
                }
                
                updateCharacterPosition();
                requestAnimationFrame(moveCharacter);
            }
            
            // 이동 루프 시작
            moveCharacter();
            
            // 처음 위치
            updateCharacterPosition();
            updateCharacterAnimation();
        });
    </script>
</body>
</html>